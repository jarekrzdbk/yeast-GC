#!/bin/bash

input=$(</dev/stdin)

     echo "$input" |
       sed '/^>/d' | while read LINE
         do
            #grep -Po '(ATG((...)*?)(TGA))|(ATG((...)*?)(TAA))|(ATG((...)*?)(TAG))' <<< "$LINE"
            grep -Po 'ATG(...)*?T(A(A|G)|GA)' <<< "$LINE" | grep -vwE '\w{1,147}'
            #perl -pe 's|(.*?)(ATG.*?TGA)(.*?)|\2\n|g' <<< "$LINE" | head -n -1
            #grep -oP 'ATG.*?(TGA|TA[AG])' <<< "$LINE" #| grep -vwE '\w{1,147}'
            #grep -oP 'ATG.*?TAG' <<< "$LINE" | grep -vwE '\w{1,147}'
         done
         